const translations = {
  'en': {
    // Navigation
    'nav.home': 'Home',
    'nav.renovation': 'Renovation',
    'nav.quotes': 'Quotes',
    'nav.stories': 'Scary Stories',
    'nav.login': 'Login',
    'nav.signup': 'Sign Up',
    'nav.logout': 'Logout',
    'nav.greeting': 'Hello, {name}!',
    
    // Home page
    'hero.title': 'Welcome to The Zala',
    'hero.tagline': '“If you don\'t give it to us, we\'ll take it ourselves!”',

    // Song Section
    'song.title': 'Song of the Week',
    'song.name': 'Sasho Roman - Of, of',
    'song.playing': 'Now playing',
    'song.unsupported': 'Your browser does not support audio playback.',
    'song.backgroundAlt': 'Song of the week background',

    // News Section
    'news.title': 'Updates from the Zala',
    'news.renovationUpdate': 'Renovation Progress', 
    'news.renovationText': ' Completed the ceiling in the weightlifting room and installed a new window, improving visuals and structure. Began and finished the wall next to the entrance in the table tennis room.',
    'news.newQuotes': 'New Quotes Added',
    'news.quotesText': 'Six new quotes added.',
    'news.date': 'October 2025',
    
    // Staff Section
    'staff.title': 'Staff',

    // The Transformer Keeper
    'staff.theTransformerKeeper.name': 'The Transformer Keeper',
    'staff.theTransformerKeeper.role': 'Head of Maintenance',
    'staff.theTransformerKeeper.bio': 'Keeps the lights flickering — and the voices clear.',
    'staff.theTransformerKeeper.quote': '"The lights flicker… but I never forget."',
    'staff.theTransformerKeeper.alt': 'The Transformer Keeper portrait',

    // Denis
    'staff.denis.name': 'Denis',
    'staff.denis.role': 'Breaks it and fixes it',
    'staff.denis.bio': 'Things always work out when I get fed up and just say “screw it.”',
    'staff.denis.quote': '"Whatever I touch ends up satisfied."',
    'staff.denis.alt': 'Denis portrait',

    // Sevgin
    'staff.sevgin.name': 'Sevgin',
    'staff.sevgin.role': 'Quote Collector',
    'staff.sevgin.bio': 'Keeper of the ancient words and modern mispronunciations.',
    'staff.sevgin.quote': '"Аузубуляха кога ли ще дойде."',
    'staff.sevgin.alt': 'Sevgin portrait',

    // Iliyan
    'staff.iliyan.name': 'Iliyan',
    'staff.iliyan.role': 'Website and community maintenance',
    'staff.iliyan.bio': 'Hanged twice, buried once.',
    'staff.iliyan.quote': '"Rope for hanging with free installation."',
    'staff.iliyan.alt': 'Denis portrait',

    // Sevdi
    'staff.sevdi.name': 'Sevdi',
    'staff.sevdi.role': 'Master of Absence',
    'staff.sevdi.bio': 'Delesanhills member.',
    'staff.sevdi.quote': '"Where there’s work, I’ve got no business being there."',
    'staff.sevdi.alt': 'Sevdi portrait',

    // Selvi
    'staff.selvi.name': 'Selvi',
    'staff.selvi.role': 'Quote Collector',
    'staff.selvi.bio': 'Keeper of the ancient words and modern mispronunciations.',
    'staff.selvi.quote': '"Аузубуляха кога ли ще дойде."',
    'staff.selvi.alt': 'Selvi portrait',

    // Dani
    'staff.dani.name': 'Dani',
    'staff.dani.role': 'The Craftsman',
    'staff.dani.bio': 'If something blows up, it’s either a storm — or I’m fixing the cables.',
    'staff.dani.quote': '"Can or can’t — just make it work somehow."',
    'staff.dani.alt': 'Dani portrait',

    // Support Section
    'support.title': 'Support & Connection',
    'support.text': 'Support the Zala and help us uncover forgotten memories.',
    'support.donateButton': 'Donate',
    'support.shareButton': 'Contact Us',

    // Location Section
    'nav.hours': 'OPEN 24/7',
    'nav.location': 'Studena, Madan Municipality, Smolyan Province',

    'location.title': 'Find Us',
    'location.subtitle': 'We await you.',

    'location.physical.title': 'Physical Space',
    'location.physical.address': 'Town Hall, Studena, 1st floor',
    'location.physical.city': 'Studena, Madan Municipality, Smolyan Province', 
    'location.physical.description': 'Where everything began',

    'location.digital.title': 'Digital Presence',
    'location.digital.platform': 'Always available online',
    'location.digital.access': 'Accessible from anywhere, anytime',
    'location.digital.description': 'From the Town Hall to the Network — the Zala remains',

    // Page titles and content
    'page.renovation.title': 'The Evolution of the Zala',
    'page.renovation.text': 'Follow our transformation through time.',
    'page.quotes.title': 'Zala Quotes',
    'page.stories.title': 'Scary Stories from the Zala',
    
    // Footer
    'footer.text': '© Zala 2025',
    
    // Auth pages
    'auth.welcomeBack': 'Welcome Back',
    'auth.enterDark': 'We\'ve been waiting for you.',
    'auth.joinZala': 'Join the Zala',
    'auth.becomePart': 'Become one of us.',
    'auth.email': 'Email',
    'auth.password': 'Password',
    'auth.fullName': 'Full Name',
    'auth.login': 'Login',
    'auth.signup': 'Sign Up',
    'auth.googleLogin': 'Login with Google',
    'auth.googleSignup': 'Sign up with Google',
    'auth.haveAccount': 'You\'re not on the list?',
    'auth.noAccount': 'So you\'re one of us now?',
    'auth.or': 'or'
  },
  'bg': {
    // Navigation
    'nav.home': 'Начало',
    'nav.renovation': 'Реновация',
    'nav.quotes': 'Цитати',
    'nav.stories': 'Страшни истории',
    'nav.login': 'Вход',
    'nav.signup': 'Регистрация',
    'nav.logout': 'Изход',
    'nav.greeting': 'Здравей, {name}!',
    
    // Home page
    'hero.title': 'Добре дошли в Залата',
    'hero.tagline': '„Ако не ни го дадеш, ще си го вземем сами!“',

    // Song Section
    'song.title': 'Песен на седмицата',
    'song.name': 'Сашо Роман - Оф, оф',
    'song.playing': 'В момента звучи',
    'song.unsupported': 'Браузърът ви не поддържа аудио възпроизвеждане.',
    'song.backgroundAlt': 'Фон за песен на седмицата',

    // News Section
    'news.title': 'Актуално от Залата',
    'news.renovationUpdate': 'Напредък по ремонта', 
    'news.renovationText': 'Завършен е таванът в залата за вдигане на тежести и е поставен нов прозорец, подобрявайки визията и конструкцията. Започната и завършена е стената до входа в залата за тенис на маса.',
    'news.newQuotes': 'Добавени цитати',
    'news.quotesText': 'Добавени са шест нови цитата.',
    'news.date': 'Октомври 2025',
    
    // Staff Section
    'staff.title': 'Екип',

    // The Transformer Keeper
    'staff.theTransformerKeeper.name': 'Поддръжката на трансформатора',
    'staff.theTransformerKeeper.role': 'Началник поддръжка',
    'staff.theTransformerKeeper.bio': 'Поддържа светлините трептящи — и гласовете ясни.',
    'staff.theTransformerKeeper.quote': '"Светлините примигват… но аз никога не забравям."',
    'staff.theTransformerKeeper.alt': 'The Transformer Keeper portrait',

    // Denis
    'staff.denis.name': 'Денис',
    'staff.denis.role': 'Чупи и оправя',
    'staff.denis.bio': 'Нещата винаги стават като ми писне и му еба майката.',
    'staff.denis.quote': '"Каквото пипне остава доволно."',
    'staff.denis.alt': 'Denis portrait',

    // Sevgin
    'staff.sevgin.name': 'Севгин',
    'staff.sevgin.role': 'Quote Collector',
    'staff.sevgin.bio': 'Keeper of the ancient words and modern mispronunciations.',
    'staff.sevgin.quote': '"Аузубуляха кога ли ще дойде."',
    'staff.sevgin.alt': 'Sevgin portrait',

    // Iliyan
    'staff.iliyan.name': 'Илиян',
    'staff.iliyan.role': 'Поддръжка на сайта и общак',
    'staff.iliyan.bio': 'Два пъти обесен, веднъж заровен.',
    'staff.iliyan.quote': '"Въже за бесене с безплатен монтаж."',
    'staff.iliyan.alt': 'Denis portrait',

    // Sevdi
    'staff.sevdi.name': 'Севди',
    'staff.sevdi.role': 'Владетелят на отсъствието',
    'staff.sevdi.bio': 'Делесанхийлс мембър.',
    'staff.sevdi.quote': '"Там дето има работа аз нямам работа."',
    'staff.sevdi.alt': 'Sevdi portrait',

    // Selvi
    'staff.selvi.name': 'Селви',
    'staff.selvi.role': 'Quote Collector',
    'staff.selvi.bio': 'Keeper of the ancient words and modern mispronunciations.',
    'staff.selvi.quote': '"Аузубуляха кога ли ще дойде."',
    'staff.selvi.alt': 'Selvi portrait',

    'staff.dani.name': 'Дани',
    'staff.dani.role': 'Майстора',
    'staff.dani.bio': 'Ако гръмне нещо, или е буря, или аз оправям кабелите.',
    'staff.dani.quote': '"Може, не може прави го някак."',
    'staff.dani.alt': 'Dani portrait',

    // Support Section
    'support.title': 'Подкрепа и Връзка',
    'support.text': 'Подкрепете Залата и ни помогнете да открием забравените спомени.',
    'support.donateButton': 'Дарение',
    'support.shareButton': 'Свържете се с нас',

    // Location Section
    'nav.hours': 'ОТВОРЕНО 24/7',
    'nav.location': 'с. Студена, общ. Мадан, обл. Смолян',

    'location.title': 'Намери ни',
    'location.subtitle': 'Очакваме те.',

    'location.physical.title': 'Адрес',
    'location.physical.address': 'Кметство, с. Студена, 1-ви етаж',
    'location.physical.city': 'с. Студена, обл. Мадан, общ. Смолян',
    'location.physical.description': 'Там, където започна всичко',

    'location.digital.title': 'Дигитално присъствие',
    'location.digital.platform': 'Винаги достъпна онлайн',
    'location.digital.access': 'Достъпна от всяко място, по всяко време',
    'location.digital.description': 'От кметството до мрежата — Залата остава.',
    
    // Page titles and content
    'page.renovation.title': 'Ремонт на Залата',
    'page.renovation.text': 'Проследете нашата трансформация през времето.',
    'page.quotes.title': 'Цитати от Залата',
    'page.stories.title': 'Страшни истории от Залата',
    
    // Footer
    'footer.text': '© Зала 2025',
    
    // Auth pages
    'auth.welcomeBack': 'Добре дошъл отново',
    'auth.enterDark': 'Очаквахме те',
    'auth.joinZala': 'Залата те очаква',
    'auth.becomePart': 'Стани част от нас',
    'auth.email': 'Имейл',
    'auth.password': 'Парола',
    'auth.fullName': 'Пълно име',
    'auth.login': 'Вход',
    'auth.signup': 'Регистрация',
    'auth.googleLogin': 'Вход с Google',
    'auth.googleSignup': 'Регистрация с Google',
    'auth.haveAccount': 'Не си в списъка?',
    'auth.noAccount': 'Вече си един от нас?',
    'auth.or': 'или'
  }
};

// Get current language from localStorage or default to 'bg'
function getCurrentLanguage() {
  return localStorage.getItem('zala-lang') || 'bg';
}

// Set current language
function setCurrentLanguage(lang) {
  localStorage.setItem('zala-lang', lang);
  return lang;
}

// Generic translation function using data attributes
function updateDataAttributeTranslations(lang) {
  const t = translations[lang];
  
  // Update elements with data-i18n
  document.querySelectorAll('[data-i18n]').forEach(element => {
    const key = element.getAttribute('data-i18n');
    if (t[key]) {
      element.textContent = t[key];
    }
  });
  
  // Update placeholder texts
  document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
    const key = element.getAttribute('data-i18n-placeholder');
    if (t[key]) {
      element.placeholder = t[key];
    }
  });
}

// Main function to set language and update UI
function setLanguage(lang) {
  const currentLang = setCurrentLanguage(lang);
  document.documentElement.lang = currentLang;
  const t = translations[currentLang];

  console.log('Setting language to:', currentLang);

  // Update navbar text (keep existing for backward compatibility)
  const navHome = document.getElementById('nav-home');
  const navRenovation = document.getElementById('nav-renovation');
  const navQuotes = document.getElementById('nav-quotes');
  const navStories = document.getElementById('nav-stories');
  const navLogin = document.getElementById('nav-login');
  const navSignup = document.getElementById('nav-signup');
  
  if (navHome) navHome.textContent = t['nav.home'];
  if (navRenovation) navRenovation.textContent = t['nav.renovation'];
  if (navQuotes) navQuotes.textContent = t['nav.quotes'];
  if (navStories) navStories.textContent = t['nav.stories'];
  if (navLogin) navLogin.textContent = t['nav.login'];
  if (navSignup) navSignup.textContent = t['nav.signup'];

  // Update data attribute translations (NEW - handles auth pages and any future pages)
  updateDataAttributeTranslations(currentLang);

  // Update footer (keep existing for backward compatibility)
  const footerText = document.getElementById('footer-text');
  if (footerText) footerText.textContent = t['footer.text'];

  // Update hero section (home page only) - keep existing
  const heroTitle = document.getElementById('hero-title');
  const heroTagline = document.getElementById('hero-tagline');
  if (heroTitle) heroTitle.textContent = t['hero.title'];
  if (heroTagline) heroTagline.textContent = t['hero.tagline'];

  // Update page-specific content - keep existing
  const bodyClass = document.body.classList;
  const pageTitle = document.getElementById('page-title');
  const pageText = document.getElementById('page-text');

  if (bodyClass.contains('renovation') && pageTitle) {
    pageTitle.textContent = t['page.renovation.title'];
    if (pageText) pageText.textContent = t['page.renovation.text'];
  }
  if (bodyClass.contains('quotes') && pageTitle) {
    pageTitle.textContent = t['page.quotes.title'];
    // Trigger quotes rendering when language changes
    if (window.renderQuotes) {
      setTimeout(() => {
        window.renderQuotes(currentLang);
      }, 100);
    }
  }
  if (bodyClass.contains('stories') && pageTitle) {
    pageTitle.textContent = t['page.stories.title'];
  }

  // Update language toggle active states
  const langEn = document.getElementById('lang-en');
  const langBg = document.getElementById('lang-bg');
  if (langEn) langEn.classList.toggle('active', currentLang === 'en');
  if (langBg) langBg.classList.toggle('active', currentLang === 'bg');

  console.log('Language update complete');
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
  console.log('DOM loaded, initializing language...');
  
  // Set initial language
  const initialLang = getCurrentLanguage();
  setLanguage(initialLang);
  
  // Add language toggle event listeners
  const langEn = document.getElementById('lang-en');
  const langBg = document.getElementById('lang-bg');
  
  if (langEn) {
    langEn.addEventListener('click', function(e) {
      e.preventDefault();
      console.log('English button clicked');
      setLanguage('en');
    });
  }
  
  if (langBg) {
    langBg.addEventListener('click', function(e) {
      e.preventDefault();
      console.log('Bulgarian button clicked');
      setLanguage('bg');
    });
  }
  
  console.log('Language system initialized');
});

// Make functions available globally for other scripts
window.setLanguage = setLanguage;
window.getCurrentLanguage = getCurrentLanguage;
window.updateDataAttributeTranslations = updateDataAttributeTranslations;